'use strict';

const buttonActions = [];
/*
  Represents a button action.
  The handler is a no-args function that runs when the URI is navigated to from a button.
*/
class Action {
  constructor(displayName, actionPathname, handler) {
    this.displayName = displayName;
    this.uri = `action://${actionPathname.split('/').map(encodeURIComponent).join('/')}`;
    this.handler = handler;
  }
  static get list() {
    return buttonActions;
  }
  static runURI(uri) {
    buttonActions.find(action => action.uri === uri).handler();
  }
}

// Default action: open settings page
buttonActions.push(new Action('Open settings page', 'open-settings', () => location.href = '/settings.html'));

// Register a handler for a custom button action (call this on every page, not at install time!)
pluginApi.registerAction = (plugin, displayName, actionPathname, handler) => {
  buttonActions.push(new Action(displayName, `${plugin.name}/${actionPathname}`, handler));
};

export default Action;
